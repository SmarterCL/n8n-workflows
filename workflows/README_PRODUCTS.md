# Products â†’ Supabase + Odoo (FREE)

This n8n workflow ingests demo products JSON, normalizes data, forces FREE pricing ($0), inserts into Supabase, and creates corresponding products in Odoo (product.template + product.product).

## Environment Variables

Set these in n8n (Instance Variables or per-credential env):

- `PRODUCTS_JSON_URL` (optional): Source of products JSON. Default: `https://demo.smarterbot.store/products.json`.
- `SUPABASE_URL`: e.g. `https://<project>.supabase.co`
- `SUPABASE_KEY`: service_role or a key with insert rights to `products` table
- `ODOO_URL`: e.g. `https://odoo.smarterbot.cl`
- `ODOO_DB`: Odoo database name
- `ODOO_USER`: Odoo user (email)
- `ODOO_PASSWORD`: Odoo password

Optionally, supply secrets from Vault and export as env before starting n8n.

## Flow

1. Fetch Products JSON
2. Normalize and force `price=0`, `is_free=true`
3. Insert all products into Supabase REST (`/rest/v1/products`)
4. For each product:
   - Authenticate against Odoo (JSON-RPC)
   - Create `product.template`
   - Create `product.product` variant linked to the template

## Supabase Schema (example)

Suggested table `products` (adjust to your schema):

```sql
create table if not exists public.products (
  id bigint generated by default as identity primary key,
  name text not null,
  sku text,
  description text,
  price numeric not null default 0,
  currency text not null default 'USD',
  is_free boolean not null default true,
  images jsonb,
  metadata jsonb,
  created_at timestamp with time zone default now()
);
```

Grant inserts to your chosen role and ensure RLS policies allow the REST key to insert.

## Odoo Notes

- JSON-RPC endpoints:
  - Auth: `common.authenticate`
  - Create: `object.execute_kw('product.template','create', [vals])`
  - Variant: `object.execute_kw('product.product','create', [vals])`
- This example creates consumable products (`type='consu'`). Adjust as needed.

## Testing

- Run with `Manual Trigger` first.
- Verify records visible in Supabase table and Odoo `Products` menu.

## Security

- Use environment variables or Vault to avoid hardcoding credentials.
- Prefer transit-encrypted storage in Vault for sensitive secrets.
